# 模型权重查看指南

本项目的交互式界面支持查看和保存手写模型的权重信息。

## 🚀 功能特点

### 1. 交互式界面中的权重查看
- **训练模型**: 每次点击"训练模型"都会真正重新训练模型
- **查看权重**: 点击"查看模型权重"按钮可查看详细的权重信息
- **自动保存**: 手写模型训练完成后自动保存权重到文件

### 2. 命令行权重查看工具
- `show_weights.py` - 命令行工具查看已保存的模型权重

## 📁 权重保存位置

```
models/weights/interactive_train/
├── linear_regression_manual_20241010_143022.pkl
├── ridge_regression_manual_20241010_143045.pkl
├── lasso_regression_manual_20241010_143108.pkl
└── elastic_net_manual_20241010_143125.pkl
```

文件命名格式: `{模型名称}_manual_{时间戳}.pkl`

## 🎮 使用方法

### 启动交互式界面
```bash
python src/model_optimization.py --interactive
```

### 界面操作步骤
1. 选择模型类型（线性回归、岭回归、Lasso回归、Elastic Net）
2. 选择实现方式（推荐选择"手动实现"）
3. 调整参数（正则化强度、学习率、最大迭代次数）
4. 点击"训练模型"按钮
5. 训练完成后，点击"查看模型权重"按钮查看详细信息

### 命令行查看工具

#### 列出所有已保存的模型
```bash
python show_weights.py --list
```

#### 查看特定模型的权重
```bash
# 查看线性回归模型
python show_weights.py --model linear_regression

# 查看岭回归模型
python show_weights.py --model ridge_regression

# 查看Lasso回归模型
python show_weights.py --model lasso_regression

# 查看Elastic Net模型
python show_weights.py --model elastic_net
```

#### 查看特定时间戳的模型
```bash
python show_weights.py --model linear_regression --timestamp 20241010_143022
```

## 📊 权重信息内容

### 基本信息
- 模型名称和实现方式
- 训练指标（R²、RMSE、MAE）
- 训练时间
- 超参数设置

### 手写模型权重详情
- 权重数量、范围、均值、标准差
- 截距值
- 权重分布统计（四分位数、中位数）
- 稀疏性分析（零权重数量）
- 具体权重值（前10个和后10个）
- 训练历史（损失变化）

### 库实现信息
- Scikit-learn系数信息
- 模型参数

## 🔍 权重分析示例

### 线性回归权重示例
```
🔧 手写实现权重详情:
   权重数量: 8
   权重范围: [-0.123456, 0.789012]
   权重均值: 0.234567
   权重标准差: 0.345678
   截距(bias): 12.345678

📈 权重分布:
   - 第一四分位数(Q1): -0.056789
   - 中位数(Q2): 0.234567
   - 第三个四分位数(Q3): 0.567890

🎯 权重稀疏性:
   - 零权重数量: 0/8 (0.0%)
   - 非零权重数量: 8/8 (100.0%)
```

### Lasso回归权重示例
```
🎯 权重稀疏性:
   - 零权重数量: 3/8 (37.5%)
   - 非零权重数量: 5/8 (62.5%)

📋 权重值:
      feature_0:    0.000000
      feature_1:    0.000000
      feature_2:    1.234567
      feature_3:    0.000000
      feature_4:    2.345678
      ...
```

## 💡 使用技巧

1. **对比不同模型的权重**: 训练相同的模型但使用不同的超参数，对比权重变化
2. **观察正则化效果**: 对比线性回归和岭回归/Lasso回归的权重差异
3. **特征重要性**: 通过权重绝对值大小判断特征重要性
4. **稀疏性分析**: Lasso回归会产生稀疏权重，可用于特征选择
5. **训练过程监控**: 通过训练历史观察模型收敛情况

## 🔧 技术细节

### 权重保存格式
每个保存的`.pkl`文件包含：
- 完整的模型对象
- 训练指标和超参数
- 权重数组（weights）和截距（bias）
- 训练历史记录
- 时间戳和元数据

### 内存管理
- 交互式界面中的模型存储在内存中
- 手写模型自动保存到磁盘文件
- 可通过命令行工具随时查看历史模型

---

**注意**: 只有选择"手动实现"时才会保存权重文件，库实现会显示相应的系数信息但不单独保存文件。