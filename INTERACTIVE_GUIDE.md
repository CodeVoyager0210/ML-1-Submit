# 交互式界面使用指南

## 🚀 启动方法

```bash
python src/model_optimization.py --interactive
```

## 🎯 使用步骤

### 1. 选择模型类型
- **线性回归**: 基础模型，无正则化
- **岭回归**: L2正则化，防止过拟合
- **Lasso回归**: L1正则化，特征选择
- **Elastic Net**: L1+L2混合正则化

### 2. 选择实现方式
- **使用sklearn库**: 标准库实现，稳定可靠
- **手动实现**: 手写代码，深入理解原理

### 3. 调整参数
- **正则化强度(alpha)**: 0.001 - 10.0
- **学习率**: 0.001 - 1.0 (仅对迭代方法有效)
- **最大迭代次数**: 100 - 5000

### 4. 训练模型
点击"**训练模型**按钮，每次都会真正重新训练模型

### 5. 查看权重
训练完成后，点击"**查看模型权重**按钮查看详细信息

## 📊 权重信息内容

### 基本信息
- 训练指标（R²、RMSE、MAE）
- 训练时间
- 超参数设置

### 权重详情（仅手写实现）
- 权重数量、范围、均值、标准差
- 截距值
- 权重分布统计
- 稀疏性分析（零权重数量）
- 具体权重值

### 库实现信息
- Scikit-learn系数信息
- 模型参数

## 💾 权重保存

**自动保存位置**: `models/weights/interactive_train/`

**文件命名**: `{模型名称}_manual_{时间戳}.pkl`

**示例文件名**:
- `linear_regression_manual_20241010_211022.pkl`
- `ridge_regression_manual_20241010_211045.pkl`
- `lasso_regression_manual_20241010_211108.pkl`
- `elastic_net_manual_20241010_211125.pkl`

## 🛠️ 命令行查看工具

### 列出所有模型
```bash
python show_weights.py --list
```

### 查看特定模型
```bash
python show_weights.py --model linear_regression
python show_weights.py --model ridge_regression
python show_weights.py --model lasso_regression
python show_weights.py --model elastic_net
```

### 查看特定时间戳的模型
```bash
python show_weights.py --model lasso_regression --timestamp 20241010_211108
```

## 🔍 权重分析示例

### Lasso回归稀疏性分析
```
🎯 权重稀疏性:
   - 零权重数量: 3/8 (37.5%)
   - 非零权重数量: 5/8 (62.5%)

📋 权重值:
      feature_0:    0.000000
      feature_1:    0.000000
      feature_2:    1.234567
      feature_3:    0.000000
      feature_4:    2.345678
```

### 岭回归权重分布
```
📈 权重分布:
   - 最小值: -0.567890
   - 最大值: 0.789012
   - 中位数: 0.123456
   - 第一四分位数(Q1): -0.123456
   - 第三个四分位数(Q3): 0.456789
```

## 💡 使用技巧

### 1. 对比不同正则化强度
- 设置不同的alpha值（0.1, 1.0, 10.0）
- 观察权重变化和稀疏性

### 2. 观察Lasso回归的特征选择
- 使用较大的alpha值
- 观察哪些特征权重变为零
- 分析特征重要性

### 3. 理解Elastic Net
- 调整l1_ratio参数
- 对比纯L1和纯L2正则化的效果

### 4. 模型性能对比
- 使用"对比所有模型"按钮
- 对比库实现和手写实现
- 分析性能差异

## ⚠️ 注意事项

1. **必须先加载数据**: 启动时会自动尝试加载预处理数据
2. **权重只保存在手动实现中**: 选择"手动实现"才能保存和查看详细权重
3. **每次训练都是独立的**: 点击"训练模型"会创建新的模型实例
4. **权重文件会累积保存**: 每次训练都会创建新的时间戳文件

## 🐛 故障排除

### 问题1: 启动时提示"未找到预处理数据"
**解决方案**: 先运行数据预处理步骤
```bash
python main.py --phase preparation
python main.py --phase preprocessing
```

### 问题2: 点击"查看模型权重"无响应
**解决方案**:
- 确保已经训练了手写实现的模型
- 检查是否选择了"手动实现"选项

### 问题3: 命令行工具找不到模型文件
**解决方案**:
- 确保使用交互式界面训练过手写模型
- 检查时间戳是否正确

## 📚 学习建议

1. **从简单开始**: 先尝试线性回归，理解基础概念
2. **逐步增加复杂度**: 依次尝试岭回归、Lasso、Elastic Net
3. **对比实现**: 对比库实现和手写实现的差异
4. **分析权重**: 深入理解正则化对权重的影响
5. **实验参数**: 尝试不同的超参数组合

---

**开始使用**: `python src/model_optimization.py --interactive`